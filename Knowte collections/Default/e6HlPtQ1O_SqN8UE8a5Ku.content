{"ops":[{"insert":"FROM debian:stretch-slim"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"FROM python:3.7"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"LABEL authors=\"José Roberto Mejía Pacheco\""},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN echo 'deb http://ftp.de.debian.org/debian stretch main' > /etc/apt/sources.list"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN echo 'deb http://deb.debian.org/debian stretch-backports main' > /etc/apt/sources.list.d/backports.list"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN echo 'deb http://ftp.debian.org/debian/ stable main contrib non-free' > /etc/apt/sources.list.d/nonfree.list"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get update"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get install \\"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"            nano \\"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"            apt-utils \\"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"            curl \\    "},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"            libsasl2-dev \\"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"            libldap2-dev \\"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"            libssl-dev -y --force-yes"},{"attributes":{"code-block":true},"insert":"\n\n"},{"insert":"RUN curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN curl https://packages.microsoft.com/config/debian/9/prod.list > /etc/apt/sources.list.d/mssql-release.list"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get update"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY ./fix_install_msodbcsql17.sh /"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN chmod a+x fix_install_msodbcsql17.sh"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN ./fix_install_msodbcsql17.sh"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get install -y unixodbc-dev"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get install -y libgssapi-krb5-2"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install pyodbc"},{"attributes":{"code-block":true},"insert":"\n\n\n"},{"insert":"RUN adduser --system --quiet --shell=/bin/bash --home=/opt/odoo --gecos 'odoo' --group odoo"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN mkdir /etc/odoo && mkdir /var/log/odoo/"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY ./entrypoint.sh /"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY ./odoo.conf /etc/odoo/"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN chown odoo /etc/odoo/odoo.conf"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN curl -o wkhtmltox.deb -sSL https://github.com/wkhtmltopdf/wkhtmltopdf/releases/download/0.12.5/wkhtmltox_0.12.5-1.stretch_amd64.deb"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN echo '7e35a63f9db14f93ec7feeb0fce76b30c08f2057 wkhtmltox.deb' | sha1sum -c -"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get install -f -y  --no-install-recommends ./wkhtmltox.deb"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN rm -rf /var/lib/apt/lists/* wkhtmltox.deb"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get update && apt-get install -y git"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY ./4G_INGENIERIA /opt/odoo/odoo"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"# RUN git clone --depth 1 --branch main https://github.com/JoseRobertoMejiaPacheco/4G_INGENIERIA /opt/odoo/odoo"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN cd /opt/odoo/odoo"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install -r /opt/odoo/odoo/requirements.txt"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN mkdir /Filestore"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN mkdir /Facturas"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN su - odoo -c \"/opt/odoo/odoo/odoo-bin --addons-path=/opt/odoo/odoo/addons -s --stop-after-init\""},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN ln -s /usr/local/bin/wkhtmltopdf /usr/bin/"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN ln -s /usr/local/bin/wkhtmltoimage /usr/bin/"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN ln -s /opt/odoo/odoo/odoo-bin /usr/bin/odoo"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN su - odoo -c \"/opt/odoo/odoo/odoo-bin --addons-path=/opt/odoo/odoo/addons -s --stop-after-init\""},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN chown -R odoo:odoo /Filestore && chmod 777 /Filestore"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"VOLUME [\"/opt/odoo/odoo/addons\", \"/opt/odoo/odoo/extra_localization\",\"/Filestore\",\"/Facturas\"]"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"EXPOSE 8069 8071"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"ENV ODOO_RC /etc/odoo/odoo.conf"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"WORKDIR /"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get install -y nodejs"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN apt-get install -y npm"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN npm i less@3.12.2 -g"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install xmltodict"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install xmltodict"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install pandas"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install  python-barcode"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN pip3 install cfdiclient"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN chown -R odoo:odoo /Filestore /Facturas && chmod 777 /Filestore /Facturas"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"VOLUME [\"/opt/odoo/odoo/addons\", \"/opt/odoo/odoo/extra_localization\",\"/Filestore\",\"/Facturas\",\"/etc/odoo\"]"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY wait-for-psql.py /usr/local/bin/wait-for-psql.py"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"USER odoo"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"ENTRYPOINT [\"/entrypoint.sh\"]"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"CMD [\"odoo\"]"},{"attributes":{"code-block":true},"insert":"\n\n\n\n\n\n"}]}